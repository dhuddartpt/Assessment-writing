<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PT Evaluation: Clinical Reasoning Lab</title>
    <style>
        body { font-family: 'Times New Roman', Times, serif; line-height: 1.6; color: #1a1a1a; max-width: 1000px; margin: 20px auto; padding: 20px; background-color: #f0f2f5; }
        h1, h2, h3 { color: #2c3e50; border-bottom: 2px solid #34495e; padding-bottom: 10px; }
        .section { background: white; padding: 20px; margin-bottom: 20px; border-radius: 4px; border: 1px solid #dcdde1; }
        .data-display { background: #f8f9fa; padding: 10px; border: 1px solid #e9ecef; margin-bottom: 10px; font-size: 0.95em; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        label { font-weight: bold; display: block; margin-top: 15px; color: #2980b9; }
        textarea { width: 100%; height: 110px; padding: 10px; margin-top: 5px; border: 2px solid #bdc3c7; border-radius: 4px; box-sizing: border-box; font-family: inherit; }
        .feedback { font-size: 0.85em; margin-top: 5px; font-weight: bold; color: #c0392b; background: #fdf2f2; padding: 8px; border-radius: 3px; border: 1px solid #f5c6cb; }
        .valid { color: #27ae60; background: #f2fdf5; border: 1px solid #27ae60; }
        .btn-reset { background-color: #7f8c8d; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #34495e; color: white; }
    </style>
</head>
<body>

    <h1>Clinical Evaluation Lab: Total Knee Arthroplasty</h1>
    <p><em>Instructions: Complete the Assessment section. The PT Diagnosis must follow the structured format provided in the syllabus image.</em></p>

    <div class="section">
        <h2>I. Subjective & II. Objective Highlights</h2>
        <div class="grid">
            <div class="data-display">
                <strong>Patient:</strong> Daniel, 68 y/o Male[cite: 83].<br>
                <strong>Surgical Hx:</strong> R TKA 2 weeks ago (01/15/2026)[cite: 25, 39].<br>
                <strong>Stage:</strong> Patient is in the early post-operative phase.<br>
                <strong>PLOF:</strong> Independent community ambulator[cite: 45].
            </div>
            <div class="data-display">
                <strong>Key Impairments:</strong> 5° extension lag, 3-/5 Quad MMT[cite: 75, 77].<br>
                <strong>Key Activities:</strong> Min A ambulation with FWW; Mod A stairs[cite: 50, 52].<br>
                <strong>Contextual Factors:</strong> 2-story home; highly motivated; supportive spouse[cite: 44, 91].
            </div>
        </div>
    </div>

    <form id="ptForm">
        <div class="section" style="border: 2px solid #2980b9;">
            <h2>III. Assessment (Graded Entry)</h2>
            
            <label>1. Summary</label>
            <textarea id="summary" oninput="validate()" placeholder="Synthesize age, race, setting, MD referral, and ICD-10[cite: 83]..."></textarea>
            <div id="v-summary" class="feedback">✕ Required: Age, Setting, and ICD-10 code[cite: 83].</div>

            <label>2. PT Diagnosis (Structured Format)</label>
            <textarea id="ptDx" oninput="validate()" placeholder='Format: "Pt presents with [condition + stage], with key impairments of [1-3 impairments], causing limitations in [1-2 activities], restricting/risking [participation role]; requires skilled PT to [target]."'></textarea>
            <div id="v-ptDx" class="feedback">✕ Required: Condition + Stage (Acute/Subacute/Chronic/Recurrent), Impairments, Activities, and Participation role[cite: 84, 85].</div>

            <label>3. Problem List</label>
            <textarea id="problems" oninput="validate()" placeholder="1) Participation, 2) Activity, 3) Impairments [cite: 86-90]..."></textarea>
            <div id="v-problems" class="feedback">✕ Required: Prioritized list starting with Participation[cite: 87].</div>

            <label>4. Prognosis & Plan</label>
            <textarea id="prognosis" oninput="validate()" placeholder="Grade: Good, Fair, Poor, or No Potential. Include 2-3 contextual factors and DC plan [cite: 91-93]..."></textarea>
            <div id="v-prognosis" class="feedback">✕ Required: Select grade (Good/Fair/Poor/No Potential), list 2-3 contextual factors, and DC plan[cite: 91, 93].</div>
        </div>

        <button type="button" class="btn-reset" onclick="resetAssessment()">RESET ASSESSMENT ONLY</button>
    </form>

    <script>
        function validate() {
            const checks = {
                summary: [/68/i, /outpatient/i, /M17\.11/i],
                // Grading logic for the uploaded image structure + chronicity stages
                ptDx: [
                    /acute|subacute|chronic|recurrent/i, 
                    /key impairments/i, 
                    /limitations in/i, 
                    /restricting|risking/i, 
                    /requires skilled PT/i
                ],
                problems: [/1\)/, /2\)/, /3\)/],
                // Grading logic for prognosis levels and contextual factors
                prognosis: [
                    /Good|Fair|Poor|No Potential/i, 
                    /(?=.*factor)(?=.*(motivated|spouse|home|stairs|support|environment))/i,
                    /DC|discharge/i
                ]
            };

            for (let id in checks) {
                let val = document.getElementById(id).value;
                let feedback = document.getElementById('v-' + id);
                let passed = checks[id].every(regex => regex.test(val));

                if (val.length > 5 && passed) {
                    feedback.innerHTML = "✓ Requirement Met";
                    feedback.className = "feedback valid";
                } else {
                    feedback.className = "feedback";
                    if(id === 'summary') feedback.innerHTML = "✕ Missing: Age (68), Setting (Outpatient), or ICD-10[cite: 83].";
                    if(id === 'ptDx') feedback.innerHTML = "✕ Error: Must include Stage (e.g. Subacute) and follow the specific Image Format: Condition + Stage -> Impairments -> Activities -> Participation -> Skilled PT Target[cite: 85].";
                    if(id === 'problems') feedback.innerHTML = "✕ Missing: Numbered list starting with Participation[cite: 87].";
                    if(id === 'prognosis') feedback.innerHTML = "✕ Missing: Grade (Good/Fair/Poor/No Potential), 2-3 Contextual Factors (e.g., motivation, home setup), and DC Plan[cite: 91, 93].";
                }
            }
        }

        function resetAssessment() {
            if (confirm("Clear assessment for a new attempt?")) {
                document.getElementById("ptForm").reset();
                validate();
            }
        }
        window.onload = validate;
    </script>
</body>
</html>